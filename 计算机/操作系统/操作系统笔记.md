# 操作系统

[TOC]

## 进程

### 创建进程

系统调用`fork()`用于创建进程，新创建的进程为子进程，原来的进程为父进程，**在C语言程序中子进程并不会从main()函数开头开始执行，而是从调用`fork()`函数之后开始执行**，就好像它也调用了fork()函数一样

子进程并不是完全拷贝了父进程，虽然子进程拥有自己的地址空间（私有内存）、寄存器以及程序计数器等，但是它从fork()返回的值是不同的，父进程获得的是新创建子进程的PID，而子进程获得的返回值是0。



## 堆（heap）和 栈（Stack）

堆用来管理动态分配的内存、用户管理的内存，堆内存的释放和申请是由程序员显式完成的

栈用来保存当前的函数调用状态分配空间给局部变量，传递参数和函数返回值，栈内存的释放和申请操作是编译器来隐式管理的，所以有时也被称为自动内存

堆是从上到下增长，栈是从下向上增长



## 内存管理单元（Memory Management Unit，MMU）

CPU中负责地址转换（虚拟内存到物理内存）的部分，每个MMU都需要基址寄存器和界限寄存器用于对地址转换和界限检查（防止越界）



## 分段

对于程序的内存区域，在堆和栈中间有一大块“空闲内存”，如果要将整个地址空间加载入内存，可能会浪费很大空间，于是可以对其进行**分段**。

在典型的地址空间里有三个逻辑不同的段：代码、栈和堆。分段的机制使得操作系统能够将不同的段放到不同的物理内存区域，从而避免了虚拟地址空间中未使用部分占用物理内存。同时也需要对每一段配置一堆基址和界限寄存器
